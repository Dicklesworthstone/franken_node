{
  "bead_id": "bd-3l2p",
  "section": "10.17",
  "title": "Intent-Aware Remote Effects Firewall",
  "schema_version": "fw-v1.0",
  "verdict": "PASS",
  "evaluation": {
    "intent_classifications": 10,
    "risky_categories": 3,
    "verdict_pathways": 5,
    "event_codes": 10,
    "error_codes": 8,
    "invariants": 5,
    "inline_tests": 37,
    "policy_rules_in_default": 10,
    "quarantine_capacity": 1000
  },
  "invariant_checks": {
    "INV-FW-FAIL-CLOSED": "enforced: unclassifiable traffic returns Deny verdict",
    "INV-FW-RECEIPT-EVERY-DECISION": "enforced: every evaluate() call produces FirewallDecision with receipt_id",
    "INV-FW-RISKY-DEFAULT-DENY": "enforced: Exfiltration, CredentialForward, SideChannel default to Deny",
    "INV-FW-DETERMINISTIC": "enforced: BTreeMap/BTreeSet ordering; same inputs produce same outputs",
    "INV-FW-EXTENSION-SCOPED": "enforced: NodeInternal traffic bypasses firewall with audit trail"
  },
  "verdict_coverage": {
    "Allow": "tested: non-risky data_fetch with registered extension",
    "Challenge": "tested: policy override to challenge pathway",
    "Simulate": "tested: policy rule with simulate verdict",
    "Deny": "tested: risky categories, unclassifiable traffic, unknown extension",
    "Quarantine": "tested: quarantine capacity enforcement"
  },
  "notes": [
    "All 10 intent classification categories have dedicated test cases.",
    "Risky categories (exfiltration, credential_forward, side_channel) verified to default-deny.",
    "Quarantine capacity overflow triggers ERR_FW_QUARANTINE_FULL.",
    "Policy overrides require non-empty justification (ERR_FW_OVERRIDE_UNAUTHORIZED).",
    "Node-internal traffic bypasses the firewall with a separate audit trail."
  ]
}
