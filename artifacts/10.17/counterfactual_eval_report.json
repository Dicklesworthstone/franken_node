{
  "schema_version": "counterfactual-lab-v1.0",
  "bead_id": "bd-383z",
  "section": "10.17",
  "title": "Counterfactual incident lab and mitigation synthesis workflow",
  "verdict": "PASS",
  "total": 39,
  "passed": 39,
  "failed": 0,
  "checks": [
    {
      "check": "Spec file exists",
      "passed": true,
      "detail": "/data/projects/franken_node/docs/specs/counterfactual_incident_lab.md"
    },
    {
      "check": "Implementation file exists",
      "passed": true,
      "detail": "/data/projects/franken_node/crates/franken-node/src/ops/mitigation_synthesis.rs"
    },
    {
      "check": "Ops mod file exists",
      "passed": true,
      "detail": "/data/projects/franken_node/crates/franken-node/src/ops/mod.rs"
    },
    {
      "check": "Main module wired",
      "passed": true,
      "detail": "pub mod ops; in main.rs"
    },
    {
      "check": "Ops mod exports mitigation_synthesis",
      "passed": true,
      "detail": "pub mod mitigation_synthesis; in ops/mod.rs"
    },
    {
      "check": "Impl token 'struct IncidentTrace'",
      "passed": true,
      "detail": "struct IncidentTrace"
    },
    {
      "check": "Impl token 'struct MitigationCandidate'",
      "passed": true,
      "detail": "struct MitigationCandidate"
    },
    {
      "check": "Impl token 'struct RolloutContract'",
      "passed": true,
      "detail": "struct RolloutContract"
    },
    {
      "check": "Impl token 'struct RollbackContract'",
      "passed": true,
      "detail": "struct RollbackContract"
    },
    {
      "check": "Impl token 'struct PromotedMitigation'",
      "passed": true,
      "detail": "struct PromotedMitigation"
    },
    {
      "check": "Impl token 'struct IncidentLab'",
      "passed": true,
      "detail": "struct IncidentLab"
    },
    {
      "check": "Impl token 'fn load_trace'",
      "passed": true,
      "detail": "fn load_trace"
    },
    {
      "check": "Impl token 'fn replay_baseline'",
      "passed": true,
      "detail": "fn replay_baseline"
    },
    {
      "check": "Impl token 'fn synthesize_mitigation'",
      "passed": true,
      "detail": "fn synthesize_mitigation"
    },
    {
      "check": "Impl token 'fn compare_replay'",
      "passed": true,
      "detail": "fn compare_replay"
    },
    {
      "check": "Impl token 'fn promote_mitigation'",
      "passed": true,
      "detail": "fn promote_mitigation"
    },
    {
      "check": "Impl token 'fn run_full_workflow'",
      "passed": true,
      "detail": "fn run_full_workflow"
    },
    {
      "check": "Impl token 'struct LabDecision'",
      "passed": true,
      "detail": "struct LabDecision"
    },
    {
      "check": "Impl token 'struct ReplayComparison'",
      "passed": true,
      "detail": "struct ReplayComparison"
    },
    {
      "check": "Impl token 'struct LabConfig'",
      "passed": true,
      "detail": "struct LabConfig"
    },
    {
      "check": "Event code LAB_INCIDENT_LOADED",
      "passed": true,
      "detail": "LAB_INCIDENT_LOADED"
    },
    {
      "check": "Event code LAB_MITIGATION_SYNTHESIZED",
      "passed": true,
      "detail": "LAB_MITIGATION_SYNTHESIZED"
    },
    {
      "check": "Event code LAB_REPLAY_COMPARED",
      "passed": true,
      "detail": "LAB_REPLAY_COMPARED"
    },
    {
      "check": "Event code LAB_LOSS_DELTA_COMPUTED",
      "passed": true,
      "detail": "LAB_LOSS_DELTA_COMPUTED"
    },
    {
      "check": "Event code LAB_MITIGATION_PROMOTED",
      "passed": true,
      "detail": "LAB_MITIGATION_PROMOTED"
    },
    {
      "check": "Error code ERR_LAB_TRACE_CORRUPT",
      "passed": true,
      "detail": "ERR_LAB_TRACE_CORRUPT"
    },
    {
      "check": "Error code ERR_LAB_REPLAY_DIVERGED",
      "passed": true,
      "detail": "ERR_LAB_REPLAY_DIVERGED"
    },
    {
      "check": "Error code ERR_LAB_MITIGATION_UNSAFE",
      "passed": true,
      "detail": "ERR_LAB_MITIGATION_UNSAFE"
    },
    {
      "check": "Error code ERR_LAB_ROLLOUT_UNSIGNED",
      "passed": true,
      "detail": "ERR_LAB_ROLLOUT_UNSIGNED"
    },
    {
      "check": "Error code ERR_LAB_ROLLBACK_MISSING",
      "passed": true,
      "detail": "ERR_LAB_ROLLBACK_MISSING"
    },
    {
      "check": "Error code ERR_LAB_LOSS_DELTA_NEGATIVE",
      "passed": true,
      "detail": "ERR_LAB_LOSS_DELTA_NEGATIVE"
    },
    {
      "check": "Invariant INV-LAB-REPLAY-FIDELITY",
      "passed": true,
      "detail": "INV-LAB-REPLAY-FIDELITY"
    },
    {
      "check": "Invariant INV-LAB-SIGNED-ROLLOUT",
      "passed": true,
      "detail": "INV-LAB-SIGNED-ROLLOUT"
    },
    {
      "check": "Invariant INV-LAB-ROLLBACK-CONTRACT",
      "passed": true,
      "detail": "INV-LAB-ROLLBACK-CONTRACT"
    },
    {
      "check": "Invariant INV-LAB-LOSS-DELTA-POSITIVE",
      "passed": true,
      "detail": "INV-LAB-LOSS-DELTA-POSITIVE"
    },
    {
      "check": "Rust unit tests >= 8",
      "passed": true,
      "detail": "found 17"
    },
    {
      "check": "Lab test exists",
      "passed": true,
      "detail": "/data/projects/franken_node/tests/lab/counterfactual_mitigation_eval.rs"
    },
    {
      "check": "Lab test has >= 10 tests",
      "passed": true,
      "detail": "found 13"
    },
    {
      "check": "Python checker unit test exists",
      "passed": true,
      "detail": "/data/projects/franken_node/tests/test_check_counterfactual_lab.py"
    }
  ],
  "event_codes": [
    "LAB_INCIDENT_LOADED",
    "LAB_MITIGATION_SYNTHESIZED",
    "LAB_REPLAY_COMPARED",
    "LAB_LOSS_DELTA_COMPUTED",
    "LAB_MITIGATION_PROMOTED"
  ],
  "error_codes": [
    "ERR_LAB_TRACE_CORRUPT",
    "ERR_LAB_REPLAY_DIVERGED",
    "ERR_LAB_MITIGATION_UNSAFE",
    "ERR_LAB_ROLLOUT_UNSIGNED",
    "ERR_LAB_ROLLBACK_MISSING",
    "ERR_LAB_LOSS_DELTA_NEGATIVE"
  ],
  "invariants": [
    "INV-LAB-REPLAY-FIDELITY",
    "INV-LAB-SIGNED-ROLLOUT",
    "INV-LAB-ROLLBACK-CONTRACT",
    "INV-LAB-LOSS-DELTA-POSITIVE"
  ],
  "lab_contract": {
    "requires_signed_rollout": true,
    "requires_rollback_contract": true,
    "requires_positive_loss_delta": true,
    "requires_trace_integrity": true
  }
}
